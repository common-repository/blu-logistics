function blsm_if_ship_to_different_address(){var e={action:blu_shipping.action};jQuery.post(blu_data.ajaxurl,e,function(e){})}function blsm_port_parcel(){jQuery.fancybox({type:"iframe",href:site_admin_url+"admin-ajax.php?action=blsm_google_map",width:"90%",height:"90%",autoScale:!1,transitionIn:"none",transitionOut:"none"})}function blsm_resend_parcel(e){jQuery("#resend-error").html("");var t={action:blu_data.action,data:"order="+e};jQuery.post(blu_data.ajaxurl,t,function(e){var t=jQuery.parseJSON(e);"success"==t.response?window.location.reload():jQuery("#resend-error").html("Order details could not be sent to blu due to an error. Please click on 'Resend' to try again.")})}function initMap(){var e,t=new google.maps.LatLngBounds,o={mapTypeId:"roadmap"};e=new google.maps.Map(document.getElementById("map"),o),e.setTilt(45);var r=jQuery.parseJSON(mapLocation),a=[],n="",i=[];jQuery.each(r,function(e,t){n=t.address1+", "+t.country;var o=[n,t.latitude,t.longitude,t.apt_id];a.push(o);var r=['<div class="info_content"><h3>'+t.name+"</h3><p>"+n+"</p></div>"];i.push(r)});var l,u,c=a,s=i,d=new google.maps.InfoWindow;for(u=0;u<c.length;u++){var p=new google.maps.LatLng(c[u][1],c[u][2]);t.extend(p),l=new google.maps.Marker({position:p,map:e,title:c[u][0],elementId:c[u][3],icon:blu_plugin_path+"/admin/img/blu-pin.png",lat:c[u][1],"long":c[u][2]}),google.maps.event.addListener(l,"click",function(t,o){return function(){jQuery("#map_location_"+t.elementId).prop("checked",!0);var r=jQuery("#location_"+t.elementId);jQuery(".mapmarker").removeClass("highlight"),r.addClass("highlight"),jQuery(".mapmarker").removeAttr("tabindex"),r.attr("tabindex","-1"),r.focus(),d.setContent(s[o][0]),d.open(e,t),e.setZoom(14),e.setCenter(new google.maps.LatLng(t.lat,t["long"]))}}(l,u)),e.fitBounds(t),e.setCenter(t.getCenter()),markerView[c[u][3]]=l}if(jQuery("#latitude").val()&&jQuery("#longitude").val()){var _=new google.maps.Marker({map:e,position:new google.maps.LatLng(jQuery("#latitude").val(),jQuery("#longitude").val()),title:"Searched location"});d.setContent("Searched location: "+jQuery("#search_location").val()),d.open(e,_),e.setCenter(new google.maps.LatLng(jQuery("#latitude").val(),jQuery("#longitude").val()));var m=new google.maps.Circle({map:e,radius:1e3,fillColor:"#4285f4",strokeWeight:0,fillOpacity:.5});m.bindTo("center",_,"position"),google.maps.event.addListenerOnce(e,"bounds_changed",function(t){e.setZoom(14),google.maps.event.removeListener(h)}),google.maps.event.addListener(_,"click",function(t){d.setContent("Searched location: "+jQuery("#search_location").val()),d.open(e,_)})}var h=google.maps.event.addListener(e,"bounds_changed",function(t){e.setZoom(11),google.maps.event.removeListener(h)});jQuery(".mapmarker").on("click",function(){google.maps.event.trigger(markerView[jQuery(this).data("marker-id")],"click"),e.setZoom(14);var t=jQuery(this).data("lat"),o=jQuery(this).data("lng"),r=new google.maps.LatLng(t,o);e.setCenter(r)})}jQuery(document).ready(function(e){jQuery("body").hasClass("blu-remove-footer")&&jQuery("footer").remove(),allowNumber(),allowAlphabet(),jQuery(".nocopy").bind("drag drop",!1),jQuery(".nocopy").bind("copy paste",!1),jQuery(".errorMsgs").hide(),jQuery(".blsm-label").removeAttr("target"),jQuery(".blsm-label").attr("target","_blank"),jQuery("#use_api").is(":checked")||(jQuery(".enable-api").attr("disabled","true"),jQuery(".blu-global-api").attr("style","display:none")),jQuery("#send_order").is(":checked")||(jQuery("#drop_off").attr("disabled","true"),jQuery("#drop_off").prop("checked",!1)),jQuery(".shipping_method").live("change",function(){var e=jQuery(this).val();"blu_terminal_shipping_method"==e&&jQuery.fancybox({type:"iframe",href:site_admin_url+"admin-ajax.php?action=blsm_google_map",width:"90%",height:"90%",autoScale:!1,transitionIn:"none",transitionOut:"none"})}),jQuery(".select-location-btn").click(function(){jQuery.fancybox({type:"iframe",href:site_admin_url+"admin-ajax.php?action=blsm_google_map",width:"90%",height:"90%",autoScale:!1,transitionIn:"none",transitionOut:"none"})}),jQuery("#use_api").click(function(){jQuery(this).is(":checked")?(jQuery(".blu-global-api").removeAttr("style"),jQuery(".enable-api").removeAttr("disabled")):(jQuery(".blu-global-api").attr("style","display:none"),jQuery(".enable-api").attr("disabled","true"))}),jQuery("#send_order").click(function(){jQuery(this).is(":checked")?jQuery("#drop_off").removeAttr("disabled"):(jQuery("#drop_off").attr("disabled","true"),jQuery("#drop_off").prop("checked",!1))});var t=jQuery("#refresh");"yes"==t.val()?location.reload(!0):t.val("yes"),jQuery("#woocommerce_blu_home_shipping_method_title,#woocommerce_blu_home_shipping_method_description,#woocommerce_blu_home_shipping_method_tracking_url,#woocommerce_blu_terminal_shipping_method_title,#woocommerce_blu_terminal_shipping_method_description,#woocommerce_blu_terminal_shipping_method_tracking_url,#woocommerce_blu_global_shipping_method_title,#woocommerce_blu_global_shipping_method_description,#woocommerce_blu_global_shipping_method_tracking_url").attr("readonly","true"),(jQuery("#woocommerce_blu_terminal_shipping_method_free_shipping:checkbox:checked").length>0||jQuery("#woocommerce_blu_home_shipping_method_free_shipping:checkbox:checked").length>0||jQuery("#woocommerce_blu_global_shipping_method_free_shipping:checkbox:checked").length>0)&&(jQuery('input[type="number"]').attr("readonly","true"),jQuery("select").addClass("disable-select"),jQuery(".blu-rate-table").hide()),jQuery("#woocommerce_blu_terminal_shipping_method_free_shipping,#woocommerce_blu_home_shipping_method_free_shipping,#woocommerce_blu_global_shipping_method_free_shipping").change(function(){jQuery(this).is(":checked")?(jQuery('input[type="number"]').attr("readonly","true"),jQuery("select").addClass("disable-select"),jQuery(".blu-rate-table").hide()):(jQuery('input[type="number"]').removeAttr("readonly"),jQuery("select").removeClass("disable-select"),jQuery(".blu-rate-table").show())}),jQuery("#ship-to-different-address-checkbox").change(function(){jQuery(this).is(":checked")&&blsm_if_ship_to_different_address()}),jQuery(".select-location-btn").click(function(){blsm_port_parcel()})});var allowNumber=function(){jQuery(".allow-number").keypress(function(e){var t=e.which?e.which:e.keyCode;return 46==t?!0:t>31&&(48>t||t>57)?!1:!0})},allowAlphabet=function(){jQuery(".allow-alphabet").keypress(function(e){var t=e.which?e.which:e.keyCode;t>47&&58>t&&32!=t&&e.preventDefault()})};if(jQuery(document.body).on("click","#clear-submit",function(){jQuery("#post-search-input").val(""),jQuery("#posts-filter").submit()}),jQuery("body").hasClass("blu-remove-footer")){var markerView=[],blu_plugin_path=plugin_url;jQuery("#default-location").on("click",function(){var e=jQuery("input[name=map_location]:checked").val(),t=jQuery("input[name=map_location]:checked").parent().parent().attr("data-marker-id"),o=(jQuery("#map_country_"+t).val(),jQuery("#map_address_"+t).val(),jQuery("#map_zip_code_"+t).val(),jQuery("#selected_map_address_"+t).val()),r=jQuery("#selected_map_location_"+t).val();if(!e)return alert("Please select a bluPort location from which you wish to collect your parcel."),!1;var a={action:"blsm_change_address",data:"change_address=true&address="+encodeURIComponent(o)+"&location="+encodeURIComponent(r)};jQuery.post("admin-ajax.php",a,function(e){var t=jQuery.parseJSON(e);parent.jQuery(".address_title").remove(),parent.jQuery(".selected_address").remove(),parent.jQuery("#selected_location_value").html(t.label),parent.jQuery.fancybox.close()})}),jQuery("#search_location").keypress(function(e){var t=e.which;return 13==t?(jQuery("#search_location_btn").click(),!1):void 0}),jQuery(document).on("click","#search_location_btn",function(){var e={action:"blsm_search_radius",data:"search_location="+jQuery("#search_location").val()};jQuery.post("admin-ajax.php",e,function(e){var t=jQuery.parseJSON(e);"success"==t.status&&(jQuery("#latitude").val(t.lat),jQuery("#longitude").val(t["long"]),initMap())})}),jQuery(window).load(function(){initMap()})}